<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Ejemplo de subir imágenes</title>
</head>
<body>
	<?php

	if (isset($_REQUEST['enviar'])) {
		// Nos llegan datos
		if (empty($_FILES['foto']['name'])) {
			echo "DEBES SUBIR ALGÚN FICHERO";
		} else {
			// Tenemos fichero!!
			if (is_uploaded_file($_FILES['foto']['tmp_name'])) {
				// Ha subido correctamente
				$tipo = mime_content_type($_FILES['foto']['tmp_name']);
				if (strstr($tipo, "image")) {
					// Es una imagen
					// Creamos nombre único
					$nombre = time() . $_FILES['foto']['name'];
					if(@move_uploaded_file($_FILES['foto']['tmp_name'], "img/".$nombre)) {
						// Se ha movido correctamente
						// Vamos a hacer un enlace y a mostrar la foto
						// El link
						echo "<center><a href='https://educacionadistancia.juntadeandalucia.es/centros/almeria/pluginfile.php/717154/mod_resource/content/1/img/$nombre' target='_blank'>Ver la foto en otra pestaña</a><br>";
						echo "<img src='https://educacionadistancia.juntadeandalucia.es/centros/almeria/pluginfile.php/717154/mod_resource/content/1/img/$nombre'>";
					} else {
						// No se ha podido mover
						echo "NO SE HA PODIDO COPIAR EL FICHERO";
					}
				} else {
					// No es una imagen
					echo "EL FICHERO DEBE SER UNA IMAGEN";
				}
			} else {
				// Problemas al subir
				echo "HA OCURRIDO UN ERROR EN LA SUBIDA";
			}
		}

	} else {
		// Cargamos por primera vez
		// Hacemos el formulario
		?>
		<form action="#" method="post" enctype="multipart/form-data">
			Introduzca el fichero que desea subir (debe ser una imagen): <br>
			<input type="file" name="foto">
			<input type="submit" value="Enviar" name="enviar">
		</form>
		<?php
	}
	?>

</body>
</html>